<!DOCTYPE html>
<html lang="en">

<head>
    <title>Pesquisa de Salas</title>

    <!-- HTML5 Shim and Respond.js IE10 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 10]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
      <![endif]-->
      <!-- Meta -->
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
      <meta name="description" content="Mega Able Bootstrap admin template made using Bootstrap 4 and it has huge amount of ready made feature, UI components, pages which completely fulfills any dashboard needs." />
      <meta name="keywords" content="bootstrap, bootstrap admin template, admin theme, admin dashboard, dashboard template, admin template, responsive" />
      <meta name="author" content="codedthemes" />
      <!-- Favicon icon -->
      <link rel="icon" href="{{ url_for('static', filename='img/logo.png') }}" type="image/x-icon">
    <!-- Google font-->
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,500" rel="stylesheet">
    <!-- waves.css -->
    <link rel="stylesheet" href="{{ url_for('static', filename='/backoffice/assets/pages/waves/css/waves.min.css') }}" type="text/css" media="all">
      <!-- Required Fremwork -->
      <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='/backoffice/assets/css/bootstrap/css/bootstrap.min.css') }}">
      <!-- waves.css -->
      <link rel="stylesheet" href="{{ url_for('static', filename='/backoffice/assets/pages/waves/css/waves.min.css') }}" type="text/css" media="all">
      <!-- themify icon -->
      <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='/backoffice/assets/icon/themify-icons/themify-icons.css') }}">
      <!-- Font Awesome -->
      <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='/backoffice/assets/icon/font-awesome/css/font-awesome.min.css') }}">
      <!-- scrollbar.css -->
      <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='/backoffice/assets/css/jquery.mCustomScrollbar.css') }}">
        <!-- am chart export.css -->
        <link rel="stylesheet" href="https://www.amcharts.com/lib/3/plugins/export/export.css" type="text/css" media="all" />
      <!-- Style.css -->
      <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='/backoffice/assets/css/style.css') }}">
      <script src="{{ url_for('static', filename='d3.js') }}"></script>
      <script type="text/javascript" src="{{ url_for('static', filename='d3.js') }}"></script>

      <script type="text/javascript">

        function check_value(){
            switch(document.andar.piso.value){
                    case "0":
                        document.getElementById("map").style.backgroundImage = "url('{{ url_for('static', filename='img/0.jpg') }}')";
                        break;
    
                    case "1":
                        document.getElementById("map").style.backgroundImage = "url('{{ url_for('static', filename='img/1.jpg') }}')"; 
                        break;
    
                    case "2":
                        document.getElementById("map").style.backgroundImage = "url('{{ url_for('static', filename='img/2.jpg') }}')"; 
                        break;
                }
            }

            function validateForm() {
                var x = document.forms["andar"]["x_pos"].value;
                var y = document.forms["andar"]["y_pos"].value;
                if (x == "" || y == "") {
                    alert("Deve marcar a posição da sala no mapa!");
                    return false;
                }
            }
    
    
    
        </script>

      <script>
        function mapResize() {
            document.getElementById("mapcont").style.height = document.getElementById("map").clientWidth+"px";
        }
        
        function myFunction() {
              let search = document.getElementById("room_name").value;
                console.log(search);
    
            fetch('/room?search='+search)
            .then(function(response) {
                  console.log(response);
                 response.text().then(function(text) {
                document.getElementById("result").innerHTML = text;
                   
                map_x = document.getElementById("map_position_x").value*document.getElementById("map").clientWidth;
                document.getElementById('point').setAttribute('cx', map_x+"px")
                map_y = document.getElementById("map_position_y").value*document.getElementById("map").clientWidth;
                document.getElementById('point').setAttribute('cy', map_y+"px")

                });
            })
        }
        </script>
  </head>

  <body onload="mapResize()">
  <!-- Pre-loader start -->
  <div class="theme-loader">
      <div class="loader-track">
          <div class="preloader-wrapper">
              <div class="spinner-layer spinner-blue">
                  <div class="circle-clipper left">
                      <div class="circle"></div>
                  </div>
                  <div class="gap-patch">
                      <div class="circle"></div>
                  </div>
                  <div class="circle-clipper right">
                      <div class="circle"></div>
                  </div>
              </div>
              <div class="spinner-layer spinner-red">
                  <div class="circle-clipper left">
                      <div class="circle"></div>
                  </div>
                  <div class="gap-patch">
                      <div class="circle"></div>
                  </div>
                  <div class="circle-clipper right">
                      <div class="circle"></div>
                  </div>
              </div>
            
              <div class="spinner-layer spinner-yellow">
                  <div class="circle-clipper left">
                      <div class="circle"></div>
                  </div>
                  <div class="gap-patch">
                      <div class="circle"></div>
                  </div>
                  <div class="circle-clipper right">
                      <div class="circle"></div>
                  </div>
              </div>
            
              <div class="spinner-layer spinner-green">
                  <div class="circle-clipper left">
                      <div class="circle"></div>
                  </div>
                  <div class="gap-patch">
                      <div class="circle"></div>
                  </div>
                  <div class="circle-clipper right">
                      <div class="circle"></div>
                  </div>
              </div>
          </div>
      </div>
  </div>
  <!-- Pre-loader end -->
  <div id="pcoded" class="pcoded">
      <div class="pcoded-overlay-box"></div>
      <div class="pcoded-container navbar-wrapper">
        {% include 'header.html' %}

          <div class="pcoded-main-container">
              <div class="pcoded-wrapper">

                {% include 'sidebar.html' %}

                  <div class="pcoded-content">
                      <!-- Page-header end -->
                        <div class="pcoded-inner-content">
                            <!-- Main-body start -->
                            <div class="main-body">
                                <div class="page-wrapper">
                                    <!-- Page-body start -->
                                    <div class="page-body"><div class="card">
                                        <div class="card-header">
                                            <h5>Adicionar Sala</h5>
                                        </div>
                                    <div class="card-block">
                                        <form method="POST" action="/insert_sala2" onsubmit="return validateForm()" id="andar" name="andar" enctype="multipart/form-data">
                                            <div class="form-group row">
                                                <label class="col-sm-2 col-form-label">Nome</label>
                                                <div class="col-sm-10">
                                                    <input type="text" id="name" name="name" class="form-control">
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label class="col-sm-2 col-form-label">Capacidade</label>
                                                <div class="col-sm-10">
                                                    <input type="number" id="capacity" name="capacity" class="form-control">
                                                </div>
                                            </div>
                                            <input type="hidden" id="x_pos" min="0" max="1" step="0.001" name="x_pos" class="form-control">      
                                            <input type="hidden" id="y_pos" min="0" max="1" step="0.001" name="y_pos" class="form-control">
                                            <div class="form-group row">
                                                <label class="col-sm-2 col-form-label">Localização</label>
                                                <div id="mapcont" class="col-md-8" style="height:100%;">
                                                    <div id="map" style="width:50%; height:100%; background-repeat: no-repeat; background-size: 100%; background-image: url('{{ url_for('static', filename='img/0.jpg') }}');">
                                                        <svg id="svg" style="position:relative; width:100%; height:100%;">
                                                        <!--<circle id="point" cx="" cy="" r="8" fill="red" />-->
                                                        </svg>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label class="col-sm-2 col-form-label">Piso</label>
                                                <div class="col-sm-10"><br>
                                                    <input type="radio" id="piso" onchange='check_value()' id="piso" name="piso" value="0" required>
                                                    <label for="0">0</label><br>
                                    
                                                    <input type="radio" id="piso" onchange='check_value()' id="piso" name="piso" value="1">
                                                    <label for="1">1</label><br> 
                                    
                                                    <input type="radio" id="piso" onchange='check_value()' id="piso" name="piso" value="2">
                                                    <label for="2">2</label><br><br>
                                    
                                                    <!--<input type="submit" value="Submit">-->
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label class="col-sm-2 col-form-label">Tipo de Sala</label>
                                                <div class="col-sm-10"><br>
                                                    <input type="radio" id="type" name="type" value="Aula" required>
                                                    <label for="Aula">Aula</label><br>
                                    
                                                    <input type="radio" id="type" name="type" value="Laboratório">
                                                    <label for="Laboratório">Laboratório</label><br> 
                                    
                                                    <input type="radio" id="type" name="type" value="Auditório">
                                                    <label for="Auditório">Auditório</label><br>
                                    
                                                    <input type="radio" id="type" name="type" value="Estudo">
                                                    <label for="Estudo">Estudo</label><br><br>
                                    
                                                    <!--<input type="submit" value="Submit">-->
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label class="col-sm-2 col-form-label">Informações sobre a sala</label>
                                                <div class="col-sm-10">
                                                    <textarea rows="5" id="info" name="info" cols="5" class="form-control"
                                                    placeholder=""></textarea>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label for="horario" class="col-sm-2 col-form-label">Horário da sala</label>
                                                <div class="col-sm-10">
                                                    <input type="file" id="horario" name="horario" class="form-control">
                                                </div>
                                            </div>
                                            <button type="submit" class="btn btn-primary waves-effect waves-light">Adicionar Sala</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
             </div>
        </div>
    </div>
    
    <!-- Required Jquery -->
    <script type="text/javascript" src="{{ url_for('static', filename='/backoffice/assets/js/jquery/jquery.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='/backoffice/assets/js/jquery-ui/jquery-ui.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='/backoffice/assets/js/popper.js/popper.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='/backoffice/assets/js/popper.js/popper.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='/backoffice/assets/pages/widget/excanvas.js') }}"></script>
    <!-- waves js -->
    <script src="{{ url_for('static', filename='/backoffice/assets/pages/waves/js/waves.min.js') }}"></script>
    <!-- jquery slimscroll js -->
    <script type="text/javascript" src="{{ url_for('static', filename='/backoffice/assets/js/jquery-slimscroll/jquery.slimscroll.js') }}"></script>
    <!-- modernizr js -->
    <script type="text/javascript" src="{{ url_for('static', filename='/backoffice/assets/js/modernizr/modernizr.js') }}"></script>
    <!-- slimscroll js -->
    <script type="text/javascript" src="{{ url_for('static', filename='/backoffice/assets/js/SmoothScroll.js') }}"></script>
    <script src="{{ url_for('static', filename='/backoffice/assets/js/jquery.mCustomScrollbar.concat.min.js') }}"></script>
    <!-- Chart js -->
    <script type="text/javascript" src="{{ url_for('static', filename='/backoffice/assets/js/chart.js/Chart.js') }}"></script>
    <!-- amchart js -->
    <script src="https://www.amcharts.com/lib/3/amcharts.js"></script>
    <script src="{{ url_for('static', filename='/backoffice/assets/pages/widget/amchart/gauge.js') }}"></script>
    <script src="{{ url_for('static', filename='/backoffice/assets/pages/widget/amchart/serial.js') }}"></script>
    <script src="{{ url_for('static', filename='/backoffice/assets/pages/widget/amchart/light.js') }}"></script>
    <script src="{{ url_for('static', filename='/backoffice/assets/pages/widget/amchart/pie.min.js') }}"></script>
    <script src="https://www.amcharts.com/lib/3/plugins/export/export.min.js"></script>
    <!-- menu js -->
    <script src="{{ url_for('static', filename='/backoffice/assets/js/pcoded.min.js') }}"></script>
    <script src="{{ url_for('static', filename='/backoffice/assets/js/vertical-layout.min.js') }}"></script>
    <!-- custom js -->
    <script type="text/javascript" src="{{ url_for('static', filename='/backoffice/assets/pages/dashboard/custom-dashboard.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='/backoffice/assets/js/script.js') }}"></script>

    <script>
        (function() {
        var svg = d3.select('#svg');
        var check = true;
        
            function drawCircle(x, y, size) {
                console.log('Drawing circle at', x, y, size);
                svg.append("circle")
                    .attr('class', 'click-circle')
                    .attr("cx", x)
                    .attr("cy", y)
                    .attr("r", size)
                    .attr("fill", "blue");
            }

            
            svg.on('click', (event) => {
                var coords = d3.pointer(event);
                console.log(coords);
                var max_w_h =  document.getElementById("map").clientWidth;
                console.log("x: "+(coords[0]/max_w_h)+"  y: "+(coords[1]/max_w_h));
                if(check == true){
                    drawCircle(coords[0], coords[1], 8);
                    document.getElementById('x_pos').value = coords[0]/max_w_h;
                    document.getElementById('y_pos').value = coords[1]/max_w_h;
                    check=false;
                }else{
                    svg.selectAll("circle.click-circle").remove();
                    document.getElementById('x_pos').value = 0;
                    document.getElementById('y_pos').value = 0;
                    check=true;
                }
                
            });

        })();
    </script>  
</body>

</html>

















